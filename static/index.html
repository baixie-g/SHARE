<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>g00jå°ç«™ - æ–‡ä»¶å…±äº«ç³»ç»Ÿ</title>
    <link rel="stylesheet" href="css/style.css">
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
</head>
<body>
    <div id="app">
        <!-- å¯¼èˆªæ  -->
        <nav class="navbar">
            <div class="nav-container">
                <div class="nav-brand">
                    <h1>ğŸ“ g00jå°ç«™</h1>
                </div>
                <div class="nav-menu">
                    <a href="#" @click="currentView = 'home'" :class="{active: currentView === 'home'}">é¦–é¡µ</a>
                    <a href="#" @click="currentView = 'files'" :class="{active: currentView === 'files'}">æ–‡ä»¶ç®¡ç†</a>
                    <a href="#" @click="currentView = 'monitor'" v-if="user && user.role === 'admin'" :class="{active: currentView === 'monitor'}">ç³»ç»Ÿç›‘æ§</a>
                </div>
                <div class="nav-auth">
                    <div v-if="!user">
                        <button @click="showLogin = true" class="btn btn-primary">ç™»å½•</button>
                        <button @click="showRegister = true" class="btn btn-secondary">æ³¨å†Œ</button>
                    </div>
                    <div v-else class="user-info">
                        <span>æ¬¢è¿, {{ user.username }} ({{ user.role }})</span>
                        <button @click="logout" class="btn btn-danger">ç™»å‡º</button>
                    </div>
                </div>
            </div>
        </nav>

        <!-- ä¸»å†…å®¹åŒºåŸŸ -->
        <main class="main-content">
            <!-- é¦–é¡µè§†å›¾ -->
            <div v-if="currentView === 'home'" class="home-view">
                <div class="hero-section">
                    <h2>æ¬¢è¿ä½¿ç”¨ g00jå°ç«™ æ–‡ä»¶å…±äº«ç³»ç»Ÿ</h2>
                    <p>ä¸€ä¸ªå®‰å…¨ã€é«˜æ•ˆçš„æ–‡ä»¶å…±äº«å¹³å°</p>
                </div>
                
                <div class="features-grid">
                    <div class="feature-card">
                        <h3>ğŸ“ æ–‡ä»¶ç®¡ç†</h3>
                        <p>æ”¯æŒå¤šç§æ–‡ä»¶ç±»å‹çš„ä¸Šä¼ ã€ä¸‹è½½å’Œé¢„è§ˆ</p>
                    </div>
                    <div class="feature-card">
                        <h3>ğŸ¥ åœ¨çº¿æ’­æ”¾</h3>
                        <p>æ”¯æŒè§†é¢‘åœ¨çº¿æ’­æ”¾å’Œæ–‡æ¡£åœ¨çº¿é˜…è¯»</p>
                    </div>
                    <div class="feature-card">
                        <h3>ğŸ” æƒé™ç®¡ç†</h3>
                        <p>ä¸‰çº§ç”¨æˆ·æƒé™ï¼Œç¡®ä¿æ•°æ®å®‰å…¨</p>
                    </div>
                    <div class="feature-card">
                        <h3>ğŸ“Š ç³»ç»Ÿç›‘æ§</h3>
                        <p>å®æ—¶ç›‘æ§ç³»ç»Ÿèµ„æºä½¿ç”¨æƒ…å†µ</p>
                    </div>
                </div>

                <!-- æœ€æ–°æ–‡ä»¶å±•ç¤º -->
                <div class="recent-files">
                    <h3>æœ€æ–°å…±äº«æ–‡ä»¶</h3>
                    <div class="file-grid">
                        <div v-for="file in recentFiles" :key="file.id" class="file-item">
                            <div class="file-icon">{{ getFileIcon(file.file_type) }}</div>
                            <div class="file-info">
                                <h4>{{ file.filename }}</h4>
                                <p>{{ formatFileSize(file.file_size) }} | {{ file.upload_time }}</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- æ–‡ä»¶ç®¡ç†è§†å›¾ -->
            <div v-if="currentView === 'files'" class="files-view">
                <div class="files-header">
                    <h2>æ–‡ä»¶ç®¡ç†</h2>
                    <button v-if="user" @click="showUpload = true" class="btn btn-primary">ä¸Šä¼ æ–‡ä»¶</button>
                </div>

                <!-- æ–‡ä»¶åˆ†ç±»ç­›é€‰ -->
                <div class="file-filters">
                    <button @click="filterCategory = ''" :class="{active: filterCategory === ''}" class="filter-btn">å…¨éƒ¨</button>
                    <button @click="filterCategory = 'video'" :class="{active: filterCategory === 'video'}" class="filter-btn">è§†é¢‘</button>
                    <button @click="filterCategory = 'document'" :class="{active: filterCategory === 'document'}" class="filter-btn">æ–‡æ¡£</button>
                    <button @click="filterCategory = 'image'" :class="{active: filterCategory === 'image'}" class="filter-btn">å›¾ç‰‡</button>
                    <button @click="filterCategory = 'other'" :class="{active: filterCategory === 'other'}" class="filter-btn">å…¶ä»–</button>
                </div>

                <!-- æ–‡ä»¶åˆ—è¡¨ -->
                <div class="files-list">
                    <div v-for="file in filteredFiles" :key="file.id" class="file-row">
                        <div class="file-icon">{{ getFileIcon(file.file_type) }}</div>
                        <div class="file-name">{{ file.filename }}</div>
                        <div class="file-size">{{ formatFileSize(file.file_size) }}</div>
                        <div class="file-date">{{ file.upload_time }}</div>
                        <div class="file-actions">
                            <button @click="previewFile(file)" class="btn btn-sm btn-info">é¢„è§ˆ</button>
                            <button v-if="user" @click="downloadFile(file)" class="btn btn-sm btn-success">ä¸‹è½½</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ç³»ç»Ÿç›‘æ§è§†å›¾ -->
            <div v-if="currentView === 'monitor' && user && user.role === 'admin'" class="monitor-view">
                <h2>ç³»ç»Ÿç›‘æ§</h2>
                
                <div class="monitor-grid">
                    <div class="monitor-card">
                        <h3>CPU ä½¿ç”¨ç‡</h3>
                        <div class="progress-circle">
                            <span class="progress-text">{{ systemStatus.cpu_usage }}%</span>
                        </div>
                    </div>
                    
                    <div class="monitor-card">
                        <h3>å†…å­˜ä½¿ç”¨ç‡</h3>
                        <div class="progress-circle">
                            <span class="progress-text">{{ systemStatus.memory_usage }}%</span>
                        </div>
                    </div>
                    
                    <div class="monitor-card">
                        <h3>ç£ç›˜ä½¿ç”¨ç‡</h3>
                        <div class="progress-circle">
                            <span class="progress-text">{{ systemStatus.disk_usage }}%</span>
                        </div>
                    </div>
                    
                    <div class="monitor-card">
                        <h3>ç³»ç»Ÿè¿è¡Œæ—¶é—´</h3>
                        <p>{{ systemStatus.uptime }}</p>
                    </div>
                </div>

                <!-- è¿›ç¨‹åˆ—è¡¨ -->
                <div class="processes-section">
                    <h3>ç³»ç»Ÿè¿›ç¨‹</h3>
                    <div class="processes-table">
                        <div class="table-header">
                            <span>PID</span>
                            <span>è¿›ç¨‹å</span>
                            <span>ç”¨æˆ·</span>
                            <span>CPU%</span>
                            <span>å†…å­˜%</span>
                        </div>
                        <div v-for="process in processes.slice(0, 10)" :key="process.pid" class="table-row">
                            <span>{{ process.pid }}</span>
                            <span>{{ process.name }}</span>
                            <span>{{ process.user }}</span>
                            <span>{{ process.cpu_percent }}%</span>
                            <span>{{ process.memory_percent }}%</span>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- ç™»å½•æ¨¡æ€æ¡† -->
        <div v-if="showLogin" class="modal-overlay" @click="showLogin = false">
            <div class="modal" @click.stop>
                <h3>ç”¨æˆ·ç™»å½•</h3>
                <form @submit.prevent="login">
                    <input v-model="loginForm.username" type="text" placeholder="ç”¨æˆ·å" required>
                    <input v-model="loginForm.password" type="password" placeholder="å¯†ç " required>
                    <button type="submit" class="btn btn-primary">ç™»å½•</button>
                    <button type="button" @click="showLogin = false" class="btn btn-secondary">å–æ¶ˆ</button>
                </form>
            </div>
        </div>

        <!-- æ³¨å†Œæ¨¡æ€æ¡† -->
        <div v-if="showRegister" class="modal-overlay" @click="showRegister = false">
            <div class="modal" @click.stop>
                <h3>ç”¨æˆ·æ³¨å†Œ</h3>
                <form @submit.prevent="register">
                    <input v-model="registerForm.username" type="text" placeholder="ç”¨æˆ·å" required>
                    <input v-model="registerForm.password" type="password" placeholder="å¯†ç " required>
                    <input v-model="registerForm.confirmPassword" type="password" placeholder="ç¡®è®¤å¯†ç " required>
                    <button type="submit" class="btn btn-primary">æ³¨å†Œ</button>
                    <button type="button" @click="showRegister = false" class="btn btn-secondary">å–æ¶ˆ</button>
                </form>
            </div>
        </div>

        <!-- æ–‡ä»¶é¢„è§ˆæ¨¡æ€æ¡† -->
        <div v-if="showPreview" class="modal-overlay" @click="showPreview = false">
            <div class="modal preview-modal" @click.stop>
                <h3>{{ previewFile.filename }}</h3>
                <div class="preview-content">
                    <div v-if="previewFile.file_type.startsWith('video/')" class="video-preview">
                        <video controls :src="`/api/stream/${previewFile.id}`"></video>
                    </div>
                    <div v-else-if="previewFile.file_type.startsWith('image/')" class="image-preview">
                        <img :src="`/api/stream/${previewFile.id}`" alt="é¢„è§ˆå›¾ç‰‡">
                    </div>
                    <div v-else-if="previewFile.file_type.startsWith('text/')" class="text-preview">
                        <pre>{{ previewContent }}</pre>
                    </div>
                    <div v-else class="unsupported-preview">
                        <p>è¯¥æ–‡ä»¶ç±»å‹ä¸æ”¯æŒé¢„è§ˆ</p>
                    </div>
                </div>
                <button @click="showPreview = false" class="btn btn-secondary">å…³é—­</button>
            </div>
        </div>
    </div>

    <script src="js/app.js"></script>
</body>
</html> 